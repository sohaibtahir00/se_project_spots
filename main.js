!function(){"use strict";const e={formSelector:".modal__container-form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__container-form_error",inputErrorClass:"modal__input_type_error",errorClass:"modal__error",errorMsgSuffix:"-error"},t=(e,t,r)=>{const n=t.id+r.errorMsgSuffix;e.querySelector("#"+n).textContent="",t.classList.remove(r.inputErrorClass)},r=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?n(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)};function o(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}const a=new class{constructor(e){let{baseUrl:t,headers:r,userBaseUrl:n}=e;this._baseUrl=t,this._headers=r,this._userBaseUrl=n}getUserInfo(){return fetch(`${this._userBaseUrl}/users/me`,{headers:this._headers}).then(o)}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(o)}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:r})}).then(o)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._userBaseUrl}/users/me`,{method:"PATCH",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:r})}).then(o)}editAvatarInfo(e){return fetch(`${this._userBaseUrl}/users/me/avatar`,{method:"PATCH",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(o)}changeLikeStatus(e,t){return fetch(`${this._userBaseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:{...this._headers,"Content-Type":"application/json"}}).then(o)}deleteCard(e){return fetch(`${this._userBaseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(o)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f54cc228-1565-4d98-b6d9-1ca0cd800e7c","Content-Type":"application/json"},userBaseUrl:"https://around-api.en.tripleten-services.com/v1"});a.getAppInfo().then((e=>{let[t,r]=e;d.textContent=t.name,u.textContent=t.about,I.src=t.avatar,r.forEach((e=>{const t=z(e);v.prepend(t)}))})).catch(console.error);const c=document.querySelector(".profile__edit-button"),l=document.querySelector("#edit-profile-modal"),s=document.querySelector(".modal__close-button"),i=l.querySelector("#profile-name-input"),d=document.querySelector(".profile__name"),u=document.querySelector(".profile__description"),m=l.querySelector("#profile-description-input"),_=l.querySelector(".modal__container-form"),h=document.querySelector(".profile__add-button"),v=(document.querySelector("#close-modal-button"),document.querySelector(".cards__list")),f=document.querySelector("#card-template"),p=document.querySelector("#add-card-modal"),y=p.querySelector(".modal__close-button"),S=(p.querySelector(".modal__submit-button"),p.querySelector(".modal__container-form")),b=p.querySelector("#add-card-name-input"),q=p.querySelector("#add-card-link-input"),C=document.querySelector("#preview-modal"),E=C.querySelector(".modal__image"),L=C.querySelector(".modal__caption"),k=C.querySelector(".modal__close-type-preview"),g=document.querySelectorAll(".modal"),x=document.querySelector("#avatar-modal"),U=document.querySelector(".profile__avatar-button"),B=x.querySelector(".modal__container-form"),T=x.querySelector(".modal__close-button"),A=(x.querySelector(".modal__submit-button"),x.querySelector("#profile-avatar-input")),I=document.querySelector(".profile__avatar"),$=document.querySelector("#delete-modal"),D=($.querySelector(".delete__buttons-container"),document.querySelector(".modal__delete-form")),j=document.querySelector(".modal__delete-close-button-img"),P=document.querySelector(".modal__cancel-button");let w,M;function N(e){const t=e.submitter;t.textContent="Deleting...",e.preventDefault(),a.deleteCard(M).then((()=>{w.remove(),J($)})).catch(console.error).finally((()=>{t.textContent="Delete"}))}function O(e,t){e.classList.add("modal_opened"),document.addEventListener("keydown",H)}function J(e,t){e.classList.remove("modal_opened"),document.removeEventListener("keydown",H)}function H(e){"Escape"===e.key&&g.forEach((e=>{e.classList.contains("modal_opened")&&J(e)}))}function z(e){const t=f.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-button"),c=t.querySelector(".card__delete-button");return r.textContent=e.name,n.alt=e.name,n.src=e.link,e.isLiked?o.classList.add("card__like-button_liked"):o.classList.remove("card__like-button_liked"),o.addEventListener("click",(t=>function(e,t){const r=e.target,n=r.classList.contains("card__like-button_liked");a.changeLikeStatus(t,n).then((e=>{r.classList.toggle("card__like-button_liked",!n)})).catch(console.error)}(t,e._id))),n.addEventListener("click",(()=>{O(C),E.src=e.link,E.alt=e.name,L.textContent=e.name})),c.addEventListener("click",(()=>function(e,t){w=e,M=t,O($)}(t,e._id))),D.addEventListener("submit",N),t}var F;D.querySelector("#modal__delete-button"),g.forEach((e=>{e.addEventListener("click",(t=>{t.target.classList.contains("modal_opened")&&J(e)}))})),c.addEventListener("click",(()=>{var r,n;i.value=d.textContent,m.value=u.textContent,r=_,n=e,[i,m].forEach((e=>{t(r,e,n)})),O(l)})),s.addEventListener("click",(()=>{J(l)})),h.addEventListener("click",(()=>{O(p)})),y.addEventListener("click",(()=>{J(p)})),k.addEventListener("click",(()=>{J(C)})),U.addEventListener("click",(()=>{O(x)})),T.addEventListener("click",(()=>{J(x)})),j.addEventListener("click",(()=>{J($)})),P.addEventListener("click",(()=>{J($)})),_.addEventListener("submit",(function(e){const t=e.submitter;t.textContent="Saving...",e.preventDefault(),a.editUserInfo({name:i.value,about:m.value}).then((e=>{d.textContent=e.name,u.textContent=e.about,J(l)})).catch(console.error).finally((()=>{t.textContent="Save"}))})),S.addEventListener("submit",(function(t){const r=t.submitter;r.textContent="Saving...",t.preventDefault();const o={name:b.value,link:q.value};a.addCard(o).then((t=>{const o=z(t);v.prepend(o),n(r,e),J(p),b.value="",q.value=""})).catch(console.error).finally((()=>{r.textContent="Save"}))})),B.addEventListener("submit",(function(t){const r=t.submitter;r.textContent="Saving...",t.preventDefault(),a.editAvatarInfo(A.value).then((t=>{I.src=t.avatar,n(r,e),J(x),A.value=""})).catch(console.error).finally((()=>{r.textContent="Save"}))})),D.addEventListener("submit",N),F=e,document.querySelectorAll(F.formSelector).forEach((n=>{((n,o)=>{const a=Array.from(n.querySelectorAll(o.inputSelector)),c=n.querySelector(o.submitButtonSelector);r(a,c,o),a.forEach((l=>{l.addEventListener("input",(function(){((r,n,o)=>{console.log(n.validationMessage),n.validity.valid?t(r,n,o):((t,r,n,o)=>{const a=r.id+e.errorMsgSuffix;t.querySelector("#"+a).textContent=n,r.classList.add(o.inputErrorClass)})(r,n,n.validationMessage,o)})(n,l,o),r(a,c,o)}))}))})(n,F)}))}();
//# sourceMappingURL=main.js.map